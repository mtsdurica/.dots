(function(){"use strict";const r="seventv-app-broadcast-channel";async function d(){const e=document.createElement("div");e.id="seventv-emoji-container",e.style.display="none",e.style.position="fixed",e.style.top="-1px",e.style.left="-1px";const t=chrome.runtime.getURL("assets/emoji"),i=11;for(let s=0;s<i;s++){const c=(await fetch(t+"/emojis"+s+".svg")).text(),n=document.createElement("div");n.id="emojis"+s,n.innerHTML=await c,e.appendChild(n)}document.head.appendChild(e)}const u=()=>{const e=document.createElement("script");e.src=chrome.runtime.getURL("site.js"),e.id="seventv-extension",e.type="module",e.setAttribute("worker_url",chrome.runtime.getURL("worker.js")),e.setAttribute("extension_origin",chrome.runtime.getURL(""));{const t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=chrome.runtime.getURL("assets/seventv.style.3.0.9.css"),t.setAttribute("charset","utf-8"),t.setAttribute("content","text/html"),t.setAttribute("http-equiv","content-type"),t.id="seventv-stylesheet",(document.head||document.documentElement).appendChild(t)}(document.head||document.documentElement).appendChild(e),setTimeout(()=>{d()},1e3)},a=new BroadcastChannel(r);u(),a.addEventListener("message",e=>{switch(e.data.type){case"seventv-create-permission-listener":{const{selector:t,id:i,origins:s,permissions:c}=e.data.data,n=document.querySelector(t);if(!n)return;n.addEventListener("switch",()=>{chrome.runtime.sendMessage({type:"permission-request",data:{id:i,origins:s,permissions:c}},{},o=>{o&&a.postMessage({type:"seventv-permission-granted",data:{id:o.id,granted:o.granted}})})});break}case"seventv-update-check":chrome.runtime.sendMessage({type:"update-check"},t=>{a.postMessage({type:"seventv-update-check-result",data:{status:t.status,version:t.version}})})}}),chrome.runtime.onMessage.addListener(e=>{switch(e.type){case"update-ready":{m(e.data.version??"");break}case"settings-sync":{p(e.data.settings??[]);break}}});function m(e){a.postMessage({type:"seventv-update-ready",data:{version:e}})}function p(e){a.postMessage({type:"seventv-settings-sync",data:{nodes:e}})}})();
