var N=Object.defineProperty;var O=(t,e,n)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var h=(t,e,n)=>(O(t,typeof e!="symbol"?e+"":e,n),n);import{a4 as x,ak as v,al as y,ar as P}from"./seventv.index.3.0.9.js";import{a as C}from"./seventv.useUserAgent.3.0.9.js";class U{constructor(){h(this,"isResolved",!1);h(this,"resolve");h(this,"reject");h(this,"then");h(this,"catch");h(this,"finally");const e=new Promise((n,o)=>{this.resolve=n,this.reject=o});this.then=(...n)=>e.then(...n),this.catch=(...n)=>e.catch(...n),this.finally=(...n)=>e.finally(...n)}emit(e){var n;this.isResolved=!0,(n=this.resolve)==null||n.call(this,e),this.resolve=void 0,this.reject=void 0}}class S extends U{constructor(n,o,f){super();h(this,"observer");this.observer=new MutationObserver(c=>{n(c,this.emit.bind(this))}),this.observer.observe(o,f)}emit(n){super.emit(n),this.disconnect()}disconnect(){var n,o;(n=this.observer)==null||n.disconnect(),this.observer=void 0,this.isResolved||(o=this.reject)==null||o.call(this,new D)}}class D extends Error{constructor(){super("ObserverPromise: Observer disconnected before resolving.")}}function z(t,e=100){let n;return(...o)=>{clearTimeout(n),n=window.setTimeout(()=>(n=void 0,t(...o)),e)}}const T="#root",_=Symbol.for("react.element"),b=Symbol.for("seventv.react.wrapper");function H(){var n;const t=document.querySelector(T);if(!t)return;const e=Reflect.get(t,"_reactRootContainer");return(n=e==null?void 0:e._internalRoot)==null?void 0:n.current}function E(t,e,n=350,o=1/0){const f=[];let c=t;const d=[];for(;!(f.length>=o);){if(!c||d.length>n){const a=d.pop();if(a){c=a.sibling;continue}else break}if(c.stateNode&&!(c.stateNode instanceof Element)){const a=c.stateNode;e(a)&&f.push(a)}d.push(c),c=c.child}return f}function k(t){for(const e in t)if(e.startsWith("__reactInternalInstance$"))return Reflect.get(t,e)}function A(t){const e=new Set;if(t.parentSelector)document.querySelectorAll(t.parentSelector).forEach(n=>{const o=k(n);o&&E(o,t.predicate,t.maxDepth).forEach(f=>e.add(f))});else{const n=H();n&&E(n,t.predicate,t.maxDepth).forEach(o=>e.add(o))}return e.size<1?new S((n,o)=>{for(const f of n)f.addedNodes.forEach(c=>{if(c instanceof Element)if(!t.parentSelector||c.matches(t.parentSelector)){const d=k(c);d&&E(d,t.predicate,t.maxDepth).forEach(a=>e.add(a))}else c.querySelectorAll(t.parentSelector).forEach(d=>{const a=k(d);a&&E(a,t.predicate,t.maxDepth).forEach(p=>e.add(p))})});e.size>0&&o(e)},document,{subtree:!0,childList:!0}):Promise.resolve(e)}function M(t,e={}){const o=C({cls:void 0,instances:[],unhooked:!1,retry:()=>f()}),f=()=>{o.watcher&&(o.watcher.disconnect(),o.watcher=void 0);const c=A(t);c instanceof S&&(o.watcher=c),c.then(d=>{if(o.unhooked)return;o.watcher=void 0;const[a]=d;if(!a)return;const p=a.constructor;if(!p)return;o.cls=p;const m=p.prototype,R=function(s){let i=Reflect.get(s,b);return i||(i=new W(s),Reflect.set(s,b,i),o.instances.push(i)),i};y(m,"componentDidMount",function(s,...i){var r,l;const u=R(this);return(l=(r=e.hooks)==null?void 0:r.mount)==null||l.call(r,u),s==null?void 0:s.apply(this,i)}),y(m,"componentDidUpdate",function(s,...i){var r,l;const u=R(this);return(l=(r=e.hooks)==null?void 0:r.update)==null||l.call(r,u),s==null?void 0:s.apply(this,i)}),y(m,"componentWillUnmount",function(s,...i){var r,l;const u=Reflect.get(this,b);if(u){const w=o.instances.findIndex(g=>g.identifier===u.identifier);w>-1&&o.instances.splice(w,1),Reflect.deleteProperty(this,b),(l=(r=e.hooks)==null?void 0:r.unmount)==null||l.call(r,u)}return s==null?void 0:s.apply(this,i)}),y(m,"render",function(s,...i){var l;const u=R(this);let r=e.replaceContents?null:s==null?void 0:s.apply(this,i);return(l=e.hooks)!=null&&l.render&&(r=e.hooks.render(u,r)),e.trackRoot&&(r=L(u,"root",r,e.containerClass)),r}),y(m,"shouldComponentUpdate",function(s,...i){var r;const u=R(this);return(r=e.hooks)!=null&&r.shouldUpdate?e.hooks.shouldUpdate(u):e.replaceContents?!1:(s==null?void 0:s.apply(this,i))??!0});for(const s of d)s.forceUpdate()},()=>{})};return f(),o}function j(t){if(t.watcher&&t.watcher.disconnect(),t.cls){const e=t.cls.prototype;v(e,"componentDidMount"),v(e,"componentDidUpdate"),v(e,"componentWillUnmount"),v(e,"render"),v(e,"shouldComponentUpdate")}for(const e of t.instances)e.component.forceUpdate();t.cls=void 0,t.instances.length=0,t.watcher=void 0,t.unhooked=!0}function I(t,e){const n={current:null};return P(n,"current",{value:o=>{o==null?delete t.domNodes[e]:t.domNodes[e]=o}}),n}function L(t,e,n,o){return{$$typeof:_,key:null,ref:I(t,e),type:"seventv-container",props:{children:n??null,class:o}}}function V(t,e){const n=M(t,e);return x(()=>j(n)),n}class W{constructor(e){h(this,"identifier");h(this,"component");h(this,"domNodes");this.identifier=Symbol(),this.component=e,this.domNodes=C({})}}export{S as O,_ as R,A as a,L as b,z as d,k as g,V as u};
