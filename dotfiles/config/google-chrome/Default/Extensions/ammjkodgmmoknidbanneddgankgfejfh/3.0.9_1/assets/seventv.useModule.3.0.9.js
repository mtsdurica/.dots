import{a as f,r as g,a9 as i,l as r}from"./seventv.useUserAgent.3.0.9.js";import{a as m,a4 as M,n as h}from"./seventv.index.3.0.9.js";const o=f({modules:{}});function $(n){return o.modules[n]??null}function k(n){const e=g(null);if(o.modules[n]&&(e.value=o.modules[n]),!e.value){const s=m(o.modules,l=>{e.value=l[n],e.value&&s()})}return e}function _(n,e){o.modules[n]=f({id:n,name:e.name,enabled:!0,depends_on:e.depends_on,instance:null});const s=i(o.modules,n),l=i(s.value,"ready"),u=g(!1),c=s.value.depends_on,d=[];for(const t of c){const a=o.modules[t];a&&d.push(new Promise(v=>{const y=m(a,()=>{a.ready&&(y(),v(a))})}))}d.length>0?(r.debug(`<Module/${e.name}>`,"Waiting for modules:",c.join(", ")),Promise.all(d).then(()=>{u.value=!0,r.debug(`<Module/${e.name}>`,`All dependencies met (${d.length})`)})):u.value=!0;function p(){const t=m(u,a=>{a&&(h(()=>t()),s.value.ready=!0,r.debug(`<Module/${e.name}>`,"Ready"))},{immediate:!0})}return M(()=>o.modules[n].ready=!1),{ready:l,dependenciesMet:u,markAsReady:p}}export{k as a,_ as d,$ as g};
